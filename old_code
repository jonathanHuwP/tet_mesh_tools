"""
run source with:
python -m cProfile -o stats.prof
"""
import pstats
import argparse
import pathlib
import io
import sys

def get_args():
    parser = argparse.ArgumentParser("")
    parser.add_argument("-f",
                        "--profile",
                        type=pathlib.Path,
                        required=True,
                        help="cProfile binary file")

    return parser.parse_args()

def main():
    args = get_args()
    if not args.profile.exists():
        print(f"File {args.profile} does not exist!", file=sys.stderr)
        return

    stats = pstats.Stats(str(args.profile))
    #for item in dir(stats):
    #    print(item)
    s = io.StringIO()
    sortby = 'cumulative'
    ps = stats.sort_stats(sortby)
    ps.print_stats()

if __name__ == "__main__":
    main()
